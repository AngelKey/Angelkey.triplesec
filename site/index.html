<!DOCTYPE html>
<html lang="en">
  <head>
    <title>TripleSec - Symmetric Encryption in the browser</title>
    <meta charset="utf-8">
    <link  href="css/bootstrap.min.css" rel="stylesheet">
    <link  href="css/site.css" rel="stylesheet">
    <link  href='http://fonts.googleapis.com/css?family=Montserrat+Alternates:400,700' rel='stylesheet' type='text/css'>
    <script type="text/javascript"   src="js/triplesec.js"></script>
    <script type="text/javascript"   src="js/jquery.js"></script>
    <script type="text/javascript"   src="js/bootstrap.min.js"></script>
    <script type="text/javascript"   src="js/iced-coffee.js"></script>
    
    <script type="text/coffeescript">

      $ ->
        textarea_auto = (ta) ->
          ta.style.overflow = 'hidden'
          ta.style.height   = 0
          ta.style.height   = "#{25 + Math.max ta.scrollHeight, 50}px"

        input_change = ->
          textarea_auto $('#demo-input-data')[0]

        reset_progress = ->
          $("#progress-summary").html ''

        add_progress = (txt) ->
          h = $("#progress-summary").html()
          $("#progress-summary").html h + txt

        $('#demo-input-data').on 'change',  -> input_change()
        $('#demo-input-data').on 'keydown', -> input_change()


        $('.btn-encrypt').on 'click', ->
          data   = new triplesec.Buffer $('#demo-input-data').val()
          key    = new triplesec.Buffer $('#demo-input-key').val()
          reset_progress()
          add_progress 'generating key...'
          add_progress 'doing something...'
          out    = triplesec.encrypt {
            data: data
            key:  key
            rng:  triplesec.rng
          }
          hex = out.toString 'hex'
          add_progress 'done'
          $("#demo-input-data").val hex
          textarea_auto $("#demo-input-data")[0]

        $('.btn-decrypt').on 'click', ->
          data   = new triplesec.Buffer $('#demo-input-data').val(), 'hex'
          key    = new triplesec.Buffer $('#demo-input-key').val()
          reset_progress()
          add_progress 'decrypting step 1...'
          add_progress 'decrypting step 2...'
          out    = triplesec.decrypt {
            data: data
            key:  key
          }
          txt = out.toString()
          add_progress 'done'
          $("#demo-input-data").val txt
          textarea_auto $("#demo-input-data")[0]

        textarea_auto $("#demo-input-data")[0]
    </script>
  </head>
  <body>
    <div class="container">

      <div class="row outer-grid">
        <div class="col-xs-3 col-md-2">
          <img src="img/logo.png" class="img-responsive">
        </div><!-- /.outer-grid's 1st column -->
        <div class="col-xs-9 col-md-10">

          <div class="brand">
            TripleSec
          </div>

          <div class="row">
            
            <div class="col-sm-8 intro">
              <p>
                <b>Governments have a lot of power</b>. Consider:
              </p>
              <ul>
                <li>the USA may compel websites &amp; businesses to "cooperate"</li>
                <li>the NSA may have already broken a popular cipher</li>
              </ul>
              <p>
                If you're a programmer and wish to store user data that only the user can read -- excluding both you and the government -- you must 
                encrypt in the browser or client app with extreme presumption. Consider 
                <b>TripleSec</b>, a simple, open-source symmetric encryption library in JavaScript. It ensures privacy
                 using
                <b class="salsa20">Salsa 20</b>, <b class="aes">AES</b>, and <b class="twofish">Twofish</b>,
                so that a failure in one will expose nothing. The 3 encryptions are combined in a
                simple technique outlined by Bruce Schneier in <i>Applied Cryptography</i>.
              </p>
              <p>
                In other words, <b>TripleSec</b> should work, unless <i>all 3</i> of these encryptions have fallen.
              </p>              
            </div>
            <div class="col-sm-4">

            </div>

          </div>
          <!-- /.row -->


          <div class="demo">

            <h3>Demo</h3>

            <div class="well">

              <form class="form-horizontal" role="form">
                <div class="form-group">
                  <div class="col-sm-7">
                    <textarea class="form-control" rows="5" placeholder="input" id='demo-input-data'></textarea>
                  </div>
                  <div class="col-sm-5">
                    <div class="row">
                      <div class="col-sm-8">
                        <input type="text" class="form-control" placeholder="key (password)" id='demo-input-key'>
                        <div id="progress-summary">
                        </div>
                      </div>
                      <div class="col-sm-4">
                        <div class="btn-group-vertical">
                          <button class="btn btn-encrypt btn-default" type="button">Encrypt</button>
                          <button class="btn btn-decrypt btn-default" type="button">Decrypt</button>
                        </div>
                      </div>
                    </div><!-- /.row -->
                  </div>
                </div>
              </form>

              <div class="encryption-output" style="display:none;">
                <h5>Output</h5>
                <textarea class="output-code form-control" id="demo-output-data"></textarea>
              </div>


            </div>

          </div>
          <!-- /.demo -->

          <div class="installation subsection">
            <h3>Installation</h3>
            <p>
              In the browser, just <code>&lt;script src="triplesec.js"&gt;&lt;/script&gt;</code>.
            </p>
            <p>
              In node, <code>npm install triplesec</code>.
            </p>
          </div>

          <div class="how-to-use subsection">
            <h3>How to Use It</h3>
            <p>
            Encryption is done by the <code>encrypt</code> function; data and key inputs
            should be of type <code>triplesec.Buffer</code>. A salt is generated automatically for you and is embedded in the ciphertext.
            </p>
            <pre>var b = triplesec.encrypt ({

  data: new triplesec.Buffer('Here is my secret message'),
  key:  new triplesec.Buffer('my-super-secret-password'),
  rng:  triplesec.rng

});

// convert the output buffer to hex
var hex = b.toString('hex');</pre>
          <p>
            And <code>decrypt</code> is easier than an CIA honeypot:
          </p><pre>var b = triplesec.decrypt ({

  data: new triplesec.Buffer(ciphertext, "hex"),
  key:  new triplesec.Buffer('my-super-secret-password')

});

var plaintext = b.toString();
</pre>

          </div>

          <div class="questions subsection">
            <h3>Anticipated Questions</h3>
            <div class="question">
              <h5>What's triplesec.Buffer?</h5>
              <h5>What's triplesec.rng?</h5>
              <h5>How are passphrases salted?</h5>
              <h5>Are slow encryptions CPU-blocking?</h5>
              <h5>Can I encrypt files with it, in the browser?</h5>
            </div>
          </div>

          <div class="whos-using subsection">
            <h3>Who's Using it?</h3>
            <p>
              We are! (<a href="http://www.twitter.com/maxtaco">Max Krohn</a> &amp; <a href="http://www.chriscoyne.com">Chris Coyne</a>). We're working on an unrelated site
              now, and TripleSec will be used to encrypt our users' keys.
            </p>
            <p>
              If you use TripleSec, please contact us, and we'll mention you here. 
            </p>
            <p>
              Here are some ideas, in case you're feeling ambitious:
            </p>
            <ul>
              <li>a triplesec browser extension for highlighting and encrypting/decrypting text on any page</li>
              <li>diary/journal</li>
              <li>key storage</li>
              <li>password manager</li>
              <li>Bitcoin wallet</li>
            </ul>
          </div>

          <div class="whos-using subsection">
            <h3>Can I help?</h3>
            <p>
              Please! We encourage <a href="foo">review of the algorithm</a>.  We'd also love to have
              an official browser extension. In our ideal world, you could highlight some text in your browser and
              TripleSec encrypt/decrypt it on any page just by entering a password.
            </p>
          </div>

        </div><!-- /.outer-grid's 2nd column -->
      </div><!-- /.outer-grid -->

    </div><!-- /.container -->

  </body>
</html>